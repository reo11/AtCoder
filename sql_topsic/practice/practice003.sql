-- https://topsic-contest.jp/contests/practice/problems/practice003

SELECT
    PREFECTURE.PF_CODE as '都道府県コード',
    PREFECTURE.PF_NAME as '都道府県名',
    P2015.TOTAL_AMT as '総人口2015年',
    P2020.TOTAL_AMT as '総人口2020年',
    ROUND(100.0 * P2020.TOTAL_AMT / P2015.TOTAL_AMT) as '人口増加率'
FROM PREFECTURE
JOIN POPU_TRANSITION as P2015 ON PREFECTURE.PF_CODE = P2015.PF_CODE AND P2015.SURVEY_YEAR = 2015
JOIN POPU_TRANSITION as P2020 ON PREFECTURE.PF_CODE = P2020.PF_CODE AND P2020.SURVEY_YEAR = 2020
WHERE ROUND(100.0 * P2020.TOTAL_AMT / P2015.TOTAL_AMT) > 100
ORDER BY 5 DESC, 1